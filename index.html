<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LaLaLeads - Dashboard Analytics CRM</title>
    <!-- Chart.js 3.x -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" integrity="sha512-ElRF6qQhNnNDZSoB9SxXvJ7z9mJY1xg1zYb5f0GdLwY0g8XyF7Vxg7G5bC5v9QnP8xqF7wE1m6bq2T0ZCk8nYw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- PapaParse -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js" integrity="sha512-u0wB5ZK1w7H8b8Y1a8iQF8QdGkQzJrHh4S3V3xP5jZ0q4Y8c6k2pJgY3q8sAhQ3sKxv5G4V1D4VfH7w3Gg3k6A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Arial', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; color: #333; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .card { background: rgba(255,255,255,0.95); border-radius: 20px; padding: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); backdrop-filter: blur(10px); transition: all 0.3s ease; margin-bottom: 20px; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 30px 60px rgba(0,0,0,0.15); }
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { color: #2c3e50; font-size: 2.5rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.1); margin-bottom: 10px; }
        .header .subtitle { color: #7f8c8d; font-size: 1.2rem; }
        h2 { color: #34495e; margin-bottom: 20px; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        .form-group { margin-bottom: 20px; }
        label { display: block; font-weight: bold; margin-bottom: 8px; color: #555; }
        input[type="text"], input[type="file"] { width: 100%; padding: 12px 16px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 16px; transition: all 0.3s ease; }
        input:focus { border-color: #3498db; outline: none; box-shadow: 0 0 10px rgba(52,152,219,0.3); transform: translateY(-2px); }
        .btn { background: linear-gradient(135deg, #3498db, #2980b9); color: white; border: none; padding: 12px 24px; border-radius: 10px; cursor: pointer; font-size: 16px; font-weight: bold; transition: all 0.3s ease; display: inline-block; margin: 5px; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(52,152,219,0.4); }
        .btn-success { background: linear-gradient(135deg, #27ae60, #229954); }
        .btn-success:hover { box-shadow: 0 10px 20px rgba(39,174,96,0.4); }
        .hidden { display: none; }
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-top: 20px; }
        .chart-container { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); transition: all 0.3s ease; position: relative; }
        .chart-container:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,0.15); }
        .chart-title { font-size: 18px; font-weight: bold; margin-bottom: 15px; color: #2c3e50; text-align: center; }
        .chart-selection { position: absolute; top: 10px; right: 10px; }
        .checkbox-container { display: flex; align-items: center; gap: 5px; }
        .export-section { text-align: center; margin-top: 30px; padding: 20px; background: rgba(255,255,255,0.9); border-radius: 15px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
        .stat-card { background: linear-gradient(135deg, #ff6b6b, #ee5a24); color: white; padding: 20px; border-radius: 15px; text-align: center; transition: all 0.3s ease; }
        .stat-card:hover { transform: scale(1.05); }
        .stat-card.blue { background: linear-gradient(135deg, #74b9ff, #0984e3); }
        .stat-card.green { background: linear-gradient(135deg, #00b894, #00a085); }
        .stat-card.orange { background: linear-gradient(135deg, #fdcb6e, #e17055); }
        .stat-card.purple { background: linear-gradient(135deg, #a29bfe, #6c5ce7); }
        .stat-value { font-size: 2rem; font-weight: bold; }
        .stat-label { font-size: 0.9rem; opacity: 0.9; }
        .filters { display: flex; flex-wrap: wrap; gap: 10px; margin: 20px 0; padding: 15px; background: rgba(255,255,255,0.8); border-radius: 10px; }
        select { padding: 8px 12px; border: 1px solid #ddd; border-radius: 5px; background: white; }
        .tooltip { position: relative; display: inline-block; }
        .tooltip .tooltiptext { visibility: hidden; width: 200px; background-color: #333; color: #fff; text-align: center; border-radius: 6px; padding: 8px; position: absolute; z-index: 1; bottom: 125%; left: 50%; margin-left: -100px; opacity: 0; transition: opacity 0.3s; font-size: 12px; }
        .tooltip:hover .tooltiptext { visibility: visible; opacity: 1; }
        .kpi-section { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .kpi-card { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border-left: 5px solid #3498db; }
        .kpi-title { font-size: 1.1rem; font-weight: bold; color: #2c3e50; margin-bottom: 10px; }
        .kpi-value { font-size: 2rem; font-weight: bold; color: #3498db; }
        .kpi-description { font-size: 0.9rem; color: #7f8c8d; margin-top: 5px; }
        .data-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .data-table th, .data-table td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        .data-table th { background-color: #f8f9fa; font-weight: bold; color: #2c3e50; }
        .data-table tbody tr:hover { background-color: #f5f5f5; }
        .company-info { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding: 20px; background: rgba(255,255,255,0.9); border-radius: 15px; }
        .logo-section h2 { color: #3498db; margin: 0; border: none; padding: 0; }
        .client-info { text-align: right; }
        .client-name { font-size: 1.5rem; font-weight: bold; color: #2c3e50; }
        .mission-date { color: #7f8c8d; }
        .small { font-size: 12px; color: #555; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="company-info">
            <div class="logo-section">
                <h2>ðŸ“Š LaLaLeads Analytics</h2>
                <p>Dashboard de Performance CRM</p>
            </div>
            <div class="client-info">
                <div class="client-name" id="clientNameHeader">Nom du Client</div>
                <div class="mission-date" id="missionDateHeader">Mission en cours</div>
            </div>
        </div>
        
        <!-- Config -->
        <div id="clientConfig" class="card">
            <h2>ðŸ“‹ Configuration du Rapport Client</h2>
            <div class="form-group">
                <label for="clientName">Nom du Client :</label>
                <input type="text" id="clientName" placeholder="Ex: North Star, Servi-Paies">
            </div>
            <div class="form-group">
                <label for="csvFile">Export CRM (fichier CSV) :</label>
                <input type="file" id="csvFile" accept=".csv">
                <p class="small">Ou <button class="btn" id="loadDemoBtn" type="button">charger les donnÃ©es de dÃ©mo</button></p>
            </div>
            <button class="btn" onclick="loadData()">ðŸ”„ Analyser les DonnÃ©es CRM</button>
        </div>

        <!-- Dashboard -->
        <div id="dashboard" class="hidden">
            <div class="card">
                <h2>ðŸ“ˆ KPIs de Performance Mission</h2>
                <div class="stats-grid">
                    <div class="stat-card blue"><div class="stat-value" id="totalContacts">-</div><div class="stat-label">Contacts TraitÃ©s</div></div>
                    <div class="stat-card green"><div class="stat-value" id="totalRDV">-</div><div class="stat-label">RDV Obtenus</div></div>
                    <div class="stat-card orange"><div class="stat-value" id="conversionRate">-</div><div class="stat-label">Taux de Conversion</div></div>
                    <div class="stat-card purple"><div class="stat-value" id="totalCampaigns">-</div><div class="stat-label">Campagnes</div></div>
                </div>
            </div>

            <div class="card">
                <h2>ðŸŽ¯ MÃ©triques DÃ©taillÃ©es</h2>
                <div class="kpi-section">
                    <div class="kpi-card"><div class="kpi-title">Performance TÃ©lÃ©phonique</div><div class="kpi-value" id="phonePerformance">-</div><div class="kpi-description">Taux de conversion pitch â†’ RDV</div></div>
                    <div class="kpi-card"><div class="kpi-title">Meilleure Campagne</div><div class="kpi-value" id="bestCampaign">-</div><div class="kpi-description">Campagne avec le meilleur taux</div></div>
                    <div class="kpi-card"><div class="kpi-title">Prospects Ã  Suivre</div><div class="kpi-value" id="followUp">-</div><div class="kpi-description">Contacts en attente de relance</div></div>
                </div>
            </div>

            <div class="card">
                <h2>ðŸŽ¯ Filtres d'Analyse</h2>
                <div class="filters" id="filtersContainer"></div>
            </div>

            <div class="card">
                <h2>ðŸ“Š Analyses Graphiques</h2>
                <div class="dashboard-grid" id="chartsContainer"></div>
            </div>

            <div class="export-section">
                <h2>ðŸ“„ GÃ©nÃ©ration du Rapport Client</h2>
                <p>SÃ©lectionnez les graphiques Ã  inclure dans votre rapport LaLaLeads</p>
                <button class="btn btn-success" onclick="generateReport()">ðŸ“Š GÃ©nÃ©rer le Rapport PDF</button>
                <button class="btn" onclick="exportToPowerPoint()">ðŸŽ¨ Export PowerPoint</button>
            </div>
        </div>
    </div>

    <script>
        let csvData = [];
        let selectedCharts = new Set();
        let charts = {};
        let analysisData = {};

        document.getElementById('loadDemoBtn').addEventListener('click', async () => {
            // fetch sample-data.csv from the same repo (works on GitHub Pages)
            const res = await fetch('sample-data.csv');
            const text = await res.text();
            const parsed = Papa.parse(text, { header: true, skipEmptyLines: true });
            csvData = parsed.data;
            initializeDashboard('Client DÃ©mo');
        });

        function loadData() {
            const clientName = document.getElementById('clientName').value;
            const fileInput = document.getElementById('csvFile');

            if (!clientName || (!fileInput.files || !fileInput.files[0])) {
                alert('Veuillez remplir le nom du client et sÃ©lectionner un fichier CSV (ou charger la dÃ©mo).');
                return;
            }

            const file = fileInput.files[0];
            Papa.parse(file, {
                header: true,
                skipEmptyLines: true,
                dynamicTyping: false,
                complete: function(results) {
                    csvData = results.data;
                    initializeDashboard(clientName);
                },
                error: function(error) {
                    alert('Erreur lors du chargement du fichier: ' + error.message);
                }
            });
        }

        function initializeDashboard(clientName) {
            document.getElementById('clientNameHeader').textContent = clientName;
            document.getElementById('missionDateHeader').textContent = new Date().toLocaleDateString('fr-FR');
            analyzeCRMData();
            document.getElementById('dashboard').classList.remove('hidden');
            updateKPIs();
            generateFilters();
            generateCharts();
        }

        function analyzeCRMData() {
            analysisData = {
                totalContacts: csvData.length,
                rdvData: csvData.filter(row => row['Phase du cycle de vie'] && row['Phase du cycle de vie'].toLowerCase().includes('rdv')),
                campaigns: [...new Set(csvData.map(row => row.Campagne).filter(c => c))],
                statuses: {},
                campaignPerformance: {}
            };
            csvData.forEach(row => {
                const status = row['Phase du cycle de vie'] || 'Non dÃ©fini';
                analysisData.statuses[status] = (analysisData.statuses[status] || 0) + 1;
            });
            analysisData.campaigns.forEach(campaign => {
                const campaignData = csvData.filter(row => row.Campagne === campaign);
                const rdvCount = campaignData.filter(row => row['Phase du cycle de vie'] && row['Phase du cycle de vie'].toLowerCase().includes('rdv')).length;
                analysisData.campaignPerformance[campaign] = {
                    total: campaignData.length,
                    rdv: rdvCount,
                    conversion: campaignData.length > 0 ? ((rdvCount / campaignData.length) * 100).toFixed(2) : 0
                };
            });
        }

        function updateKPIs() {
            document.getElementById('totalContacts').textContent = analysisData.totalContacts;
            document.getElementById('totalRDV').textContent = analysisData.rdvData.length;
            document.getElementById('totalCampaigns').textContent = analysisData.campaigns.length;
            const globalConversion = analysisData.totalContacts > 0 ? ((analysisData.rdvData.length / analysisData.totalContacts) * 100).toFixed(2) : 0;
            document.getElementById('conversionRate').textContent = globalConversion + '%';

            const pitchContacts = csvData.filter(row => row['Last used Aircall tags'] && row['Last used Aircall tags'].toLowerCase().includes('pitch')).length;
            const phoneConversion = pitchContacts > 0 ? ((analysisData.rdvData.length / pitchContacts) * 100).toFixed(1) : 0;
            document.getElementById('phonePerformance').textContent = phoneConversion + '%';

            let bestCampaign = ''; let bestRate = 0;
            Object.entries(analysisData.campaignPerformance).forEach(([campaign, data]) => {
                if (parseFloat(data.conversion) > bestRate) { bestRate = parseFloat(data.conversion); bestCampaign = campaign; }
            });
            document.getElementById('bestCampaign').textContent = bestCampaign || 'N/A';

            const followUpCount = csvData.filter(row => row['Phase du cycle de vie'] && (row['Phase du cycle de vie'].toLowerCase().includes('callback') || row['Phase du cycle de vie'].toLowerCase().includes('Ã  traiter') || row['Phase du cycle de vie'].toLowerCase().includes('suivre'))).length;
            document.getElementById('followUp').textContent = followUpCount;
        }

        function generateFilters() {
            const filtersContainer = document.getElementById('filtersContainer');
            filtersContainer.innerHTML = '';
            if (analysisData.campaigns.length > 1) {
                const campaignSelect = document.createElement('select');
                campaignSelect.innerHTML = '<option value="">Toutes les campagnes</option>';
                analysisData.campaigns.forEach(campaign => { campaignSelect.innerHTML += `<option value="${campaign}">${campaign}</option>`; });
                campaignSelect.onchange = () => applyFilters();
                campaignSelect.setAttribute('data-column', 'Campagne');
                const label = document.createElement('label'); label.textContent = 'Campagne: '; label.appendChild(campaignSelect); filtersContainer.appendChild(label);
            }
            const phases = [...new Set(csvData.map(row => row['Phase du cycle de vie']).filter(p => p))];
            if (phases.length > 1) {
                const phaseSelect = document.createElement('select');
                phaseSelect.innerHTML = '<option value="">Toutes les phases</option>';
                phases.forEach(phase => { phaseSelect.innerHTML += `<option value="${phase}">${phase}</option>`; });
                phaseSelect.onchange = () => applyFilters();
                phaseSelect.setAttribute('data-column', 'Phase du cycle de vie');
                const label = document.createElement('label'); label.textContent = 'Phase: '; label.appendChild(phaseSelect); filtersContainer.appendChild(label);
            }
        }

        function applyFilters() { generateCharts(); }

        function getFilteredData() {
            const filters = document.querySelectorAll('#filtersContainer select');
            let filteredData = [...csvData];
            filters.forEach(filter => {
                const column = filter.getAttribute('data-column');
                const value = filter.value;
                if (value) { filteredData = filteredData.filter(row => row[column] === value); }
            });
            return filteredData;
        }

        function generateCharts() {
            const chartsContainer = document.getElementById('chartsContainer');
            chartsContainer.innerHTML = '';
            const data = getFilteredData();

            // Chart 1: campaign perf
            createChartContainer('campaignPerf', 'Performance par Campagne', () => {
                const ctx = document.getElementById('campaignPerf').getContext('2d');
                const campaignData = {};
                data.forEach(row => {
                    const campaign = row.Campagne || 'Non dÃ©fini';
                    if (!campaignData[campaign]) { campaignData[campaign] = { total: 0, rdv: 0 }; }
                    campaignData[campaign].total++;
                    if (row['Phase du cycle de vie'] && row['Phase du cycle de vie'].toLowerCase().includes('rdv')) { campaignData[campaign].rdv++; }
                });
                const labels = Object.keys(campaignData);
                const conversions = labels.map(label => campaignData[label].total > 0 ? ((campaignData[label].rdv / campaignData[label].total) * 100).toFixed(1) : 0);
                charts.campaignPerf = new Chart(ctx, {
                    type: 'bar',
                    data: { labels, datasets: [{ label: 'Taux de Conversion (%)', data: conversions, backgroundColor: 'rgba(52,152,219,0.8)', borderColor: 'rgba(52,152,219,1)', borderWidth: 2 }] },
                    options: {
                        responsive: true,
                        plugins: {
                            tooltip: { callbacks: { afterLabel: (context) => { const campaign = context.label; const campData = campaignData[campaign]; return `RDV: ${campData.rdv}/${campData.total}`; } } }
                        },
                        scales: { y: { beginAtZero: true, ticks: { callback: (value) => value + '%' } } }
                    }
                });
            });

            // Chart 2: status distribution
            createChartContainer('statusDist', 'RÃ©partition des Statuts', () => {
                const ctx = document.getElementById('statusDist').getContext('2d');
                const statusData = {};
                data.forEach(row => { const status = row['Phase du cycle de vie'] || 'Non dÃ©fini'; statusData[status] = (statusData[status] || 0) + 1; });
                charts.statusDist = new Chart(ctx, {
                    type: 'doughnut',
                    data: { labels: Object.keys(statusData), datasets: [{ data: Object.values(statusData), backgroundColor: ['rgba(52,152,219,0.8)','rgba(46,204,113,0.8)','rgba(231,76,60,0.8)','rgba(241,196,15,0.8)','rgba(155,89,182,0.8)','rgba(230,126,34,0.8)'], borderWidth: 2, borderColor: '#fff' }] },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: { position: 'bottom' },
                            tooltip: { callbacks: { label: (context) => { const total = Object.values(statusData).reduce((a,b)=>a+b,0); const percentage = ((context.parsed / total) * 100).toFixed(1); return `${context.label}: ${context.parsed} (${percentage}%)`; } } }
                        }
                    }
                });
            });

            // Chart 3: Top companies by volume (horizontal bar using indexAxis: 'y')
            createChartContainer('companyVolume', 'Top 10 Entreprises par Volume', () => {
                const ctx = document.getElementById('companyVolume').getContext('2d');
                const companyData = {};
                data.forEach(row => { const company = row["Nom de l'entreprise"] || 'Non dÃ©fini'; companyData[company] = (companyData[company] || 0) + 1; });
                const sortedCompanies = Object.entries(companyData).sort(([,a],[,b]) => b - a).slice(0, 10);
                charts.companyVolume = new Chart(ctx, {
                    type: 'bar',
                    data: { labels: sortedCompanies.map(([company]) => company.length > 20 ? company.substring(0,20) + '...' : company), datasets: [{ label: 'Nombre de contacts', data: sortedCompanies.map(([,count]) => count), backgroundColor: 'rgba(46,204,113,0.8)', borderColor: 'rgba(46,204,113,1)', borderWidth: 1 }] },
                    options: { responsive: true, indexAxis: 'y', plugins: { legend: { display: false } } }
                });
            });

            // Table
            createTableContainer('perfTable', 'Performance DÃ©taillÃ©e par Campagne', () => {
                const tableContainer = document.getElementById('perfTable');
                let tableHTML = `<table class="data-table"><thead><tr><th>Campagne</th><th>Contacts</th><th>RDV</th><th>Conversion</th><th>Callbacks</th></tr></thead><tbody>`;
                Object.entries(analysisData.campaignPerformance).forEach(([campaign, perfData]) => {
                    const campaignContacts = data.filter(row => row.Campagne === campaign);
                    const callbacks = campaignContacts.filter(row => row['Phase du cycle de vie'] && row['Phase du cycle de vie'].toLowerCase().includes('callback')).length;
                    tableHTML += `<tr><td>${campaign}</td><td>${perfData.total}</td><td>${perfData.rdv}</td><td>${perfData.conversion}%</td><td>${callbacks}</td></tr>`;
                });
                tableHTML += '</tbody></table>';
                tableContainer.innerHTML = tableHTML;
            });
        }

        function createChartContainer(chartId, title, chartFunction) {
            const chartsContainer = document.getElementById('chartsContainer');
            const container = document.createElement('div');
            container.className = 'chart-container';
            container.innerHTML = `
                <div class="chart-selection">
                    <div class="checkbox-container tooltip">
                        <input type="checkbox" id="select_${chartId}" onchange="toggleChart('${chartId}')">
                        <label for="select_${chartId}">Inclure</label>
                        <span class="tooltiptext">Inclure ce graphique dans le rapport</span>
                    </div>
                </div>
                <div class="chart-title">${title}</div>
                <canvas id="${chartId}" width="400" height="200"></canvas>
            `;
            chartsContainer.appendChild(container);
            setTimeout(chartFunction, 100);
        }

        function createTableContainer(tableId, title, tableFunction) {
            const chartsContainer = document.getElementById('chartsContainer');
            const container = document.createElement('div');
            container.className = 'chart-container';
            container.innerHTML = `
                <div class="chart-selection">
                    <div class="checkbox-container tooltip">
                        <input type="checkbox" id="select_${tableId}" onchange="toggleChart('${tableId}')">
                        <label for="select_${tableId}">Inclure</label>
                        <span class="tooltiptext">Inclure ce tableau dans le rapport</span>
                    </div>
                </div>
                <div class="chart-title">${title}</div>
                <div id="${tableId}"></div>
            `;
            chartsContainer.appendChild(container);
            setTimeout(tableFunction, 100);
        }

        function toggleChart(chartId) {
            const checkbox = document.getElementById(`select_${chartId}`);
            if (checkbox.checked) { selectedCharts.add(chartId); } else { selectedCharts.delete(chartId); }
        }

        function generateReport() {
            if (selectedCharts.size === 0) { alert('Veuillez sÃ©lectionner au moins un graphique ou tableau pour le rapport'); return; }
            const clientName = document.getElementById('clientNameHeader').textContent;
            const reportElements = Array.from(selectedCharts);
            const reportSummary = `RAPPORT LALALEADS - ${clientName}\n===============================\n\nðŸ“Š RÃ‰SUMÃ‰ EXÃ‰CUTIF:\nâ€¢ Total contacts: ${analysisData.totalContacts}\nâ€¢ RDV obtenus: ${analysisData.rdvData.length}\nâ€¢ Taux de conversion global: ${((analysisData.rdvData.length / Math.max(analysisData.totalContacts,1)) * 100).toFixed(2)}%\nâ€¢ Campagnes analysÃ©es: ${analysisData.campaigns.length}\n\nðŸ“ˆ Ã‰LÃ‰MENTS SÃ‰LECTIONNÃ‰S POUR LE RAPPORT:\n${reportElements.map(id => 'â€¢ ' + document.querySelector('#select_'+id).parentElement.parentElement.parentElement.querySelector('.chart-title').textContent).join('\n')}\n\nðŸŽ¯ RECOMMANDATIONS:\nâ€¢ Optimiser les campagnes avec les meilleurs taux de conversion\nâ€¢ Relancer les prospects en statut "callback"\nâ€¢ Analyser les facteurs de succÃ¨s des meilleures performances`;
            alert(`GÃ©nÃ©ration du rapport PDF LaLaLeads...\n\n${reportSummary}\n\n(IntÃ©gration PDF en cours de dÃ©veloppement)`);
        }

        function exportToPowerPoint() {
            if (selectedCharts.size === 0) { alert('Veuillez sÃ©lectionner au moins un graphique pour l\'export PowerPoint'); return; }
            const clientName = document.getElementById('clientNameHeader').textContent;
            const reportElements = Array.from(selectedCharts);
            alert(`Export PowerPoint LaLaLeads en cours...\n\nClient: ${clientName}\nSlides gÃ©nÃ©rÃ©es: ${reportElements.length + 1} (1 slide rÃ©sumÃ© + ${reportElements.length} slides graphiques)\n\n(IntÃ©gration PowerPoint en cours de dÃ©veloppement)`);
        }
    </script>
</body>
</html>
